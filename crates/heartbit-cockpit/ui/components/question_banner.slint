import { Button } from "std-widgets.slint";

export struct QuestionOptionData {
    label: string,
    description: string,
    selected: bool,
    index: int,
}

export component QuestionBanner inherits Rectangle {
    in property <bool> visible-question;
    in property <string> header;
    in property <string> question-text;
    in property <bool> multiple;
    in property <string> progress;
    in property <[QuestionOptionData]> options;

    callback select-option(int);
    callback submit-answers();

    visible: visible-question;
    background: #1e3a5f;
    border-radius: 8px;
    vertical-stretch: 0;

    VerticalLayout {
        padding: 12px;
        spacing: 8px;

        // Header row
        HorizontalLayout {
            spacing: 8px;
            alignment: start;

            Text {
                text: header;
                color: #60a5fa;
                font-size: 14px;
                font-weight: 700;
            }

            if progress != "" : Text {
                text: progress;
                color: #64748b;
                font-size: 12px;
                vertical-alignment: center;
            }
        }

        // Question text
        Text {
            text: question-text;
            color: #e2e8f0;
            font-size: 13px;
            wrap: word-wrap;
        }

        // Options
        for opt in options : TouchArea {
            height: opt.description != "" ? 44px : 32px;
            clicked => { select-option(opt.index); }

            Rectangle {
                background: opt.selected ? #2563eb : #334155;
                border-radius: 6px;
                border-width: 1px;
                border-color: opt.selected ? #3b82f6 : #475569;

                VerticalLayout {
                    padding-left: 10px;
                    padding-right: 10px;
                    padding-top: 6px;
                    padding-bottom: 6px;
                    spacing: 2px;

                    Text {
                        text: opt.label;
                        color: #f8fafc;
                        font-size: 13px;
                        font-weight: 600;
                    }

                    if opt.description != "" : Text {
                        text: opt.description;
                        color: opt.selected ? #bfdbfe : #94a3b8;
                        font-size: 11px;
                        overflow: elide;
                    }
                }
            }
        }

        // Submit button for multi-select
        if multiple : HorizontalLayout {
            alignment: end;
            Button {
                text: "Done";
                clicked => { submit-answers(); }
            }
        }
    }
}
